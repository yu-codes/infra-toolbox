# ============================================
# PostgreSQL 邏輯備份服務配置
# Logical Backup (pg_dump/pg_restore)
# ============================================

# --- PostgreSQL 連接配置 ---
# 連接模式: docker (Docker 網路內連接) 或 host (直接連接宿主機 PostgreSQL)
# 當 POSTGRES_CONNECTION_MODE=host 時，可連接非 Docker 運行的 PostgreSQL
POSTGRES_CONNECTION_MODE=docker

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=your_password
POSTGRES_DATABASE=your_database

# --- 備份目錄 (容器內路徑) ---
BACKUP_DIR=/backups

# ============================================
# 備份保留設定
# ============================================

# 完全備份保留天數 (建議: 30 天)
FULL_BACKUP_RETENTION_DAYS=30

# 增量備份保留天數 (建議: 7 天)
INCREMENTAL_BACKUP_RETENTION_DAYS=7

# 異地備份保留天數 (建議: 90 天)
REMOTE_BACKUP_RETENTION_DAYS=90

# ============================================
# 壓縮與加密配置
# ============================================

# 壓縮: gzip (DEFLATE 無損壓縮)
BACKUP_COMPRESSION_ENABLED=true

# 加密開關
BACKUP_ENCRYPTION_ENABLED=false

# 加密算法 (支援: aes-256-cbc, aes-128-cbc, aes-256-gcm, chacha20-poly1305, aes-192-cbc)
# 預設: aes-256-cbc (最廣泛支援)
# 推薦: aes-256-gcm (較新且更安全)
BACKUP_ENCRYPTION_ALGORITHM=aes-256-cbc

# 加密密碼 (啟用加密時必填)
BACKUP_ENCRYPTION_PASSWORD=your_secure_encryption_password

# ============================================
# 異地備份配置 (SSH/SCP)
# ============================================

# 異地備份開關
REMOTE_BACKUP_ENABLED=false

# SSH 連接資訊
REMOTE_BACKUP_HOST=
REMOTE_BACKUP_PORT=22
REMOTE_BACKUP_USER=
REMOTE_BACKUP_PATH=/remote/backup/path

# SSH 私鑰路徑 (容器內)
REMOTE_BACKUP_SSH_KEY=/scripts/ssh/id_rsa

# ============================================
# 還原服務配置
# ============================================

# --- 還原目標配置 (可覆蓋備份配置) ---
RESTORE_POSTGRES_HOST=
RESTORE_POSTGRES_PORT=
RESTORE_POSTGRES_USERNAME=
RESTORE_POSTGRES_PASSWORD=
RESTORE_POSTGRES_DATABASE=

# --- 還原選項 ---
# 是否在還原前清空目標資料庫
RESTORE_DROP_DATABASE=false
# 是否在還原前建立資料庫 (若不存在)
RESTORE_CREATE_DATABASE=true
