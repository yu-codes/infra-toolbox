# ============================================
# PostgreSQL 物理備份服務配置
# Physical Backup (WAL-based PITR)
# ============================================

# --- PostgreSQL 連接配置 ---
# 連接模式: docker (Docker 網路內連接) 或 host (直接連接宿主機 PostgreSQL)
# 當 POSTGRES_CONNECTION_MODE=host 時，可連接非 Docker 運行的 PostgreSQL
POSTGRES_CONNECTION_MODE=docker

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=your_password
POSTGRES_DATABASE=your_database

# --- 備份目錄 (容器內路徑) ---
BACKUP_DIR=/backups

# PostgreSQL WAL 歸檔目錄 (來自 postgres 容器)
POSTGRES_WAL_DIR=/postgres_backups/wal

# ============================================
# Base Backup 設定
# ============================================

# Base Backup 保留天數 (建議: 7 天)
BASE_BACKUP_RETENTION_DAYS=7

# 備份格式: tar (壓縮) 或 plain (目錄)
BASE_BACKUP_FORMAT=tar

# 壓縮: gzip
BASE_BACKUP_COMPRESSION=true

# ============================================
# 加密配置
# ============================================

# Base Backup 加密開關
BACKUP_ENCRYPTION_ENABLED=false

# 加密算法 (支援: aes-256-cbc, aes-128-cbc, aes-256-gcm, chacha20-poly1305, aes-192-cbc)
# 預設: aes-256-cbc (最廣泛支援)
# 推薦: aes-256-gcm (較新且更安全)
BACKUP_ENCRYPTION_ALGORITHM=aes-256-cbc

# 加密密碼 (啟用加密時必填)
BACKUP_ENCRYPTION_PASSWORD=your_secure_encryption_password

# ============================================
# WAL 歸檔設定
# ============================================

# WAL 歸檔保留天數 (建議: 14 天)
WAL_RETENTION_DAYS=14

# WAL 壓縮
WAL_COMPRESSION=true

# WAL 加密 (獨立於 Base Backup 加密)
WAL_ENCRYPTION_ENABLED=false

# ============================================
# 異地備份配置 (SSH/SCP)
# ============================================

# 異地備份開關
REMOTE_BACKUP_ENABLED=false

# SSH 連接資訊
REMOTE_BACKUP_HOST=
REMOTE_BACKUP_PORT=22
REMOTE_BACKUP_USER=
REMOTE_BACKUP_PATH=/remote/backup/path

# SSH 私鑰路徑 (容器內)
REMOTE_BACKUP_SSH_KEY=/scripts/ssh/id_rsa

# 異地備份保留天數
REMOTE_BACKUP_RETENTION_DAYS=90

# ============================================
# PITR 還原配置
# ============================================

# 還原暫存目錄
RESTORE_STAGING_DIR=/backups/restore_staging

# 還原目標配置 (可覆蓋連接配置)
RESTORE_POSTGRES_HOST=
RESTORE_POSTGRES_PORT=
RESTORE_POSTGRES_USERNAME=
RESTORE_POSTGRES_PASSWORD=
